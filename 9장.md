## 센티널

### 고가용성 기능의 필요성
+ 레디스는 인메모리 데이터베이스
    - 모든 데이터는 메모리에서 관리하며 따로 백업 설정을 하지 않았을 때, 인스턴스가 재시작되면 모든 데이터가 유실된다
    - 복제본을 구성하면 마스터에 장애가 발생했을 경우, 데이터는 복제본 노드에 남아있으나 클라이언트가 마스터에 직접 접근하여 레디스의 엔드포인트를 복제본의 IP로 변경해야 한다
    - 운영환경이면 엔드포인트를 변경하는 동안 서비스에 장애가 발생

### 센티널이란?
+ 레디스의 고가용성 솔루션
    - 마스터-슬레이브 구조에서 페일오버(자동 장애 조치)를 제공하는 분산 시스템
+ 센티널은 독립적인 프로세스로 동작
+ 레디스 인스턴스들을 모니터링하고 장애 상황에서 자동으로 복구작업을 수행
+ 핵심 기능
    - 모니터링
        + 레디스 마스터와 슬레이브 인스턴스의 상태를 지속적으로 감시
        + 정기적으로 PING을 보내 응답 확인
        + 네트워크 분할이나 인스턴스 장애를 탐지
    - 알림
        + 레디스 인스턴스의 상태 변화시 관리자나 애플리케이션에 알림
        + 스크립트를 통해 커스텀 알림 처리도 가능하다
    - 페일오버
        + 마스터에 장애발생시 슬레이브를 마스터로 승격
        + 다른 슬레이브들을 새 마스터에 연결
        + 페일오버 과정에서 최소한의 데이터 손실 보장
    - 인스턴스 구성정보 안내
        + 클라이언트에게 현재 마스터의 정보 제공
            - 변경된 마스터의 정보를 전달하기 때문에 레디스 엔드포인트를 변경할 필요없음
+ 센티널 아키텍처 구성요소
    - 쿼럼(Quorum)
        + 센티널은 오탐을 줄이기 위해 쿼럼이라는 개념을 사용
        + 센티널은 최소 3대 이상 사용하는 것이 권장된다
            - 왜 3대 이상이어야 할까?
                + 마스터 장애 판정과 조치에는 과반수 이상의 센티널 동의가 필요
                + 센티널이 2대 : 1대 장애시 쿼럼 달성 불가
                + 센티널이 3대 : 1대 장애시에도 쿼럼 달성 가능